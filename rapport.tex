\documentclass[openany, 12pt]{memoir}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english, french]{babel}

%%% Utility packages
% Links
\usepackage{hyperref}
\hypersetup{
	colorlinks,
	linkcolor = blue!30!black,
	citecolor = blue!30!black,
	urlcolor = purple!40!black
}
\usepackage[colorinlistoftodos]{todonotes}
\setuptodonotes{inline, color=blue!40!red!20}
% Bibliography
\usepackage{tocbibind}
\bibliographystyle{plain}
% Glossary
\usepackage[toc, automake]{glossaries}
\input{glos}
\makeglossaries

%%% Display packages
\usepackage{graphicx}
\usepackage{fullpage}
\usepackage{xcolor}
% Headers
\setlength{\headheight}{16pt}
% Fonts
\usepackage{helvet}
\usepackage{inconsolata}
\renewcommand{\familydefault}{\sfdefault}

%%% Custom commands
% Unnumbered in toc
\newcommand\chapters[1]{
	\chapter*{#1}
	\addcontentsline{toc}{chapter}{#1}
}

% Easily include image in annexes
\newcommand\anneximage[3]{
	\begin{figure}
		\centering
		\includegraphics[angle=#2,height=0.93\textheight,width=\textwidth,keepaspectratio]{images/#1.png}
		\caption{#3}
		\label{#1}
	\end{figure}
}

\newenvironment{centerall}
    {\begin{center}\vspace*{\fill}}
    {\vspace*{\fill}\end{center}}

% DOCUMENT
\begin{document}
\frontmatter
{
	% Header
	\begin{minipage}{0.5\textwidth}
		\large
		Mémoire de PFE
		
		\vspace{10pt}
		Formation FIL
		
		\vspace{10pt}
		IMT Atlantique
	\end{minipage}
	\begin{minipage}{0.45\textwidth}
		\raggedleft
        \includegraphics[width=\textwidth]{images/header.png}
	\end{minipage}

	% Title
	\centering
    \begin{minipage}{\textwidth}
        \centering
        \vspace{20pt}
        \Large \textbf{Amélioration des performances de détection automatique d'anomalies dans des logs applicatifs}
        
        \vspace{5pt}
        \Large Oscar Gloaguen
        
        \vspace{60pt}
        Direction Générale des Finances Publiques
    \end{minipage}
    
    % Logos
    \begin{figure}[b]
        \centering
        \includegraphics[width=\textwidth]{images/logos.png}
    \end{figure}
}

\tableofcontents

\newpage
\chapters{Remerciements}
Je souhaite remercier la Direction Générale des Finances Publiques et tout particulièrement Olivier Blanc, pour m'avoir permis d'effectuer mon alternance dans cette équipe et pour m'avoir accompagné tout au long jusqu'au PFE.

\bigskip
Je tiens a remercier personnellement Robin Gries, qui a su être un vrai coéquipier tout au long de ce projet malgré sa complexité.

\bigskip
Je voudrais aussi remercier IMT Atlantique ainsi que ses professeurs, et surtout mon tuteur pédagogique Thomas Ledoux qui s'est mis a ma disposition pour le PFE.

\newpage
\begin{abstract}
\addcontentsline{toc}{chapter}{Résumé}
Les \glspl{log} sont une source importante de données détaillant le fonctionnement interne d'une application, mais ne sont pourtant que rarement utilisés a leur plein potentiel. Dans ce mémoire, je vais détailler le processus d'évolution d'un outil d'\gls{ml} qui utilise les \glspl{log} pour détecter et même tenter de prévoir des anomalies logicielles. Le projet s'apparentant plus a un projet de recherche, la démarche scientifique sera détaillée, ainsi que les caractéristiques techniques et le déroulement de l'implémentation. L'organisation du projet avec un stagiaire et moi-même sera développée, ainsi que ses impacts humains et économiques.
\end{abstract}

{\selectlanguage{english} 
\begin{abstract}
\Glspl{log} are an important source of data when it comes to the internal workings of software, but they are rarely used to their full potential. In this memoir, I will explain the evolution of a machine learning tool which uses \glspl{log} to detect and even attempt to predict software anomalies. The project being similar to a research project, the scientific protocol will be detailed, as well as the technical characteristics and the course of the implementation. Project management with an intern and myself will be developed, as well as the human and economic impacts of the project.
\end{abstract}}

\paragraph{Mots-clés}
\gls{TAL}, apprentissage automatique, apprentissage profond, analyse de logs applicatifs

% Main content
\mainmatter
\glsresetall
\chapters{Introduction}
\todo{1-2 pages}

Le projet \texttt{analyse-logs} a été développé par deux précédents apprentis de la \gls{DGFiP}, Rémi puis Léa. Cependant, les performances des algorithmes implémentés n'étant pas satisfaisantes, c'est ici que nait le sujet de ce PFE. Ce mémoire détaille le processus d'évolution de ce projet dans l'objectif d'amélioration des performances.

\bigskip
J'ai travaillé sur cette problématique en binôme avec Robin, un stagiaire en dernière année de master. Ce document touchera aussi sur l'organisation du sujet entre nous ainsi que les bénéfices et difficultés a travailler en équipe.

\bigskip
Ce sujet de PFE s'intègre dans la stratégie d'innovation du SI de la \gls{DGFiP}. L'objectif est de montrer l'efficacité de ces outils, pour mettre en valeur l'innovation et pousser leur utilisation au sein des bureaux. Dans ce cadre, une structure proche de celle d'un projet de recherche a été suivie. Pour cela, nous avons d'abord composé et étudié un état de l'art des algorithmes de détection d'anomalies existants. Ils utilisent pour la plupart des méthodes d'\gls{ml}, avec des algorithmes classiques ou de l'\gls{deep}.

\newpage
\chapter{La DGFiP, administration en évolution constante}
La \gls{DGFiP} est une administration française née de la fusion de la Direction \gls{DGI} et de la \gls{DGCP} en 2008. Elle hérite alors des missions des deux entités, en faisant un service public très étendu, en charge notamment de la collecte des impôts et taxes et de la législation fiscale. 

Cette administration possède une hiérarchie forte séparée en 8 services, qui définit leur domaine de travail, ainsi que différentes directions (voir organigramme \ref{orga} en annexes). Une majorité des services sont des services métiers, directement en lien avec les missions de la \gls{DGFiP}, mais 3 de ces services sont des services support, ou \glspl{transverse}. Ces derniers sont le service des Ressources Humaines, le service de Stratégie, Pilotage et Budget, et le \gls{SI}. Malgré une interaction indirecte avec le domaine métier des dinances publiques, ils répondent aux besoins de la \gls{DGFiP} en permettant le bon fonctionnement des autres services, ou même en améliorant leur performance.

\bigskip

Comme toute grande structure aujourd'hui, la \gls{DGFiP} possède un besoin très fort en technologies de l'information, qui est rempli par le \gls{SI}. Ce service est indispensable, car de nombreuses missions de la DGFiP reposent sur des programmes (e.g., calcul et déclarations d'impôts et des taxes) permettant de traiter de larges quantités de données en un temps restreint. Les premières versions de ces applications datent des années 80, et ont pour la plupart évolué et sont restées utilisées jusque aujourd'hui. L'informatique est donc au centre de cette administration, autant pour les agents en interne que pour les utilisateurs externes.

Le \gls{SI} est séparé en de nombreux bureaux (voir annexe \ref{orga_si}). Il comprend lui même des bureaux \glspl{transverse} qui facilitent le bon fonctionnement des autres bureaux. Le reste des bureaux est regroupé sous la \gls{DPN}, et sont chargés du pilotage, du développement et de la maintenance d'applications d'un domaine précis.

Cette nouvelle hiérarchie date de 2021, où une réorganisation a eu lieu. En effet, la \gls{DPN} n'existait pas avant cela, et les bureaux étaient regroupés sous deux directions, ``étude et développement'' et ``production''. Le \gls{SI} comporte aujourd'hui plus de bureaux, qui sont donc plus spécialisés, avec par exemple des bureaux en charge d'une unique mission importante.

\bigskip

Le \gls{BSI-3} est un bureau de la \gls{DPN} chargé de la fiscalité des professionnels, dirigé par Alain Kerdoncuff. Il a a sa charge une dizaine d'applications qu'il spécifie, développe et maintient. L'une d'entre elles est \gls{MEDOC} qui est une application d'encaissement d'impôts et de gestion de comptabilité de l'État. Le \gls{BSI-3} possède une mission particulière de modernisation de cette application, tâche très complexe étant donné son échelle et sa complexité.

Ce bureau était auparavant nommé SI-1C, et ses missions n'ont pas changé avec la réorganisation. Cependant, chacun des bureaux sont encore spécialisés en plusieurs divisions, chacune en charge de projets spécifiques. Ces divisions ont elle changé avec la réorganisation, notamment une en particulier qui a été supprimée, la \gls{DTT}. Cette dernière, chapeautée par Olivier Blanc (aussi mon tuteur) était à la fois une aide technique sur le domaine du logiciel, ainsi qu'une division détachée des projets principaux, permettant de mettre en avant des technologies innovantes et des projets expérimentaux.

\todo{Parler de la cellule innovation?}
\todo{Détailler avec des chiffres}

\newpage
\chapter{L'existant: le projet \texttt{analyse-logs}}

\section{Contexte du projet}

Si le premier chapitre peut mettre quoi que ce soit en avant, c'est bien le besoin très fort en informatique de la \gls{DGFiP}, rempli par le \gls{SI} et ses très nombreuses applications. Mais un parc applicatif si étendu pose un problème majeur~: celui de la maintenance. En effet, la maintenance logicielle est un processus très coûteux, surtout en termes d'heures de travail de personnes qualifiées. Ce sont les développeurs des applications à maintenir qui doivent effectuer cette maintenance, car c'est eux qui connaissent le fonctionnement interne de l'application.

Une solution serait de former des équipes de maintenance au différents logiciels. Malheureusement, cela demanderait encore plus de moyens, à la fois prenant encore du temps aux développeurs, mais aussi nécessitant d'embaucher des personnes qui travailleraient a temps plein sur la maintenance, ce qui n'est pas envisageable. Il n'est même pas donné que cela libère vraiment du temps aux développeurs, étant donné l'évolution constante des logiciels et les formations supplémentaires qu'il faudrait donner pour tenir une équipe de maintenance à jour.

\bigskip
Il y a 4 ans, mon tuteur Olivier Blanc s'est penché sur la question. Le vrai problème était bien de faire gagner du temps aux développeurs en facilitant et accélérant la maintenance d'une application. Dans le cas d'une erreur dans l'application qui stopperait partiellement ou complètement son fonctionnement, sa correction est obligatoire pour les équipes. Le problème de retrouver la source de cette erreur et de la corriger est alors aussi important, et c'est ici que rentrent en jeu les \glspl{log} applicatifs (voir partie suivante). Olivier mit en avant le papier de recherche DeepLog \cite{deeplog}, dont le but était d'utiliser les logs pour détecter et prédire les erreurs, ainsi que remonter vers leur cause initiale. Le projet \texttt{analyse-logs} est alors né, commençant comme sujet de PFE de Rémi Grison, apprenti a la DGFiP en 2019.

\newpage
\section{Que sont les logs~?}
\label{logs}

Le terme ``log'' est tiré de l'anglais et signifie a l'origine ``journal'', tel un journal de voyage. Il décrit donc un document contenant une liste chronologique d'évènements datés, qui peuvent être utilisés pour reformer l'histoire de ce qui s'est passé. Ils sont utiles dans le cas d'un accident, comme par exemple les journaux décrivant les voyages d'explorateurs ou aujourd'hui les boites noires dans l'aviation.

Les logs informatiques découlent de cette définition, décrivant le chemin d'exécution d'une application, d'un site, ou même d'un système d'exploitation. Ces fichiers de logs sont séparés en lignes de logs (souvent appelée un ``log'') qui contiennent des informations communes a chaque ligne, ainsi que le message de log qui est la partie variable. Les informations communes vont en général être au minimum la date, l'heure et le niveau du log. Le niveau représente la gravité de l'information présentée, en général décomposée de cette façon~:

\begin{enumerate}
	\setcounter{enumi}{-1}
	\item \texttt{DEBUG}~: Log utile pour débugger l'application, qui sera en général utilisé par le développeur. Ce log ne devrait pas être trouvé dans des fichiers de logs d'un logiciel en production.
	\item \texttt{INFO}~: Information sur le statut fonctionnel d'une application, qui peuvent être utiles et compréhensibles d'un point de vue métier.
	\item \texttt{WARNING}~: Anomalie logicielle non bloquante pour l'application, peut être fonctionnelle ou logicielle mais ne nécessite pas d'action immédiate.
	\item \texttt{ERROR}~: Anomalie logicielle bloquante, souvent un bloc logiciel qui cesse de fonctionner. Nécessite en général une intervention assez rapide, pour éviter d'autres erreurs au sein du système.
\end{enumerate}

Grâce a ces informations, un développeur (ou quelqu'un chargé de la maintenance) sera capable de retrouver les anomalies qui ont eu lieu ainsi que de remonter les causes de ces anomalies. C'est un processus en général assez manuel, qui nécessite souvent de comparer les logs et le code source, et où la recherche par mot clé peut s'avérer très utile.

\section{Blocs logiciels}

\subsection{DeepLog}

\subsection{Autres algorithmes}

\subsection{Blockly}

\newpage
\chapter{Le processus scientifique au cœur du projet}

\section{État de l'art de l'analyse de logs}

\section{Analyse des jeux de données disponibles}

\section{Organisation des tâches}

\newpage
\chapter{Développement du nouveau projet}

\newpage
\chapter{Projection de l'impact du projet}

\newpage
\chapters{Conclusion}

% BIBLIOGRAPHIE
\newpage
\backmatter
\pagenumbering{gobble}
\bibliography{biblio}

% GLOSSAIRES
\printglossary[type=admin,nonumberlist]
\newpage
\printglossary[type=tech,nonumberlist]

% ANNEXES
\newpage
\appendix
\begin{centerall}
	\textbf{\HUGE Annexes}
	\addcontentsline{toc}{chapter}{Annexes}
\end{centerall}

\anneximage{orga}{90}{Organigramme des services de la \gls{DGFiP}}
\anneximage{orga_si}{0}{Organigramme des bureaux du \gls{SI}}

\listoftodos

\end{document}
